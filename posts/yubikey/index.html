<!doctype html><html><head><title>YubiKey 5C commit signing and SSH authentication</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/layouts/main.css><link rel=stylesheet href=/css/navigators/navbar.css><link rel=stylesheet href=/css/plyr.css><link rel=stylesheet href=/google-fonts/Mulish/mulish.css><link rel=stylesheet href=/fontawesome/css/all.min.css><link rel=stylesheet href=/css/colortheme/colortheme.css><link rel=icon type=image/png href=/images/site/ProtonDark_huf55f086d68c415c8a5704a5012e4d3cc_88195_42x0_resize_box_3.png><meta property="og:title" content="YubiKey 5C commit signing and SSH authentication"><meta property="og:description" content="Setting Up the YubiKey 5C for Development with GPG Commit Signing and SSH Authentication"><meta property="og:type" content="article"><meta property="og:url" content="https://ruffles.dev/posts/yubikey/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-10-07T08:18:16+00:00"><meta property="article:modified_time" content="2022-10-07T08:18:16+00:00"><meta name=description content="Setting Up the YubiKey 5C for Development with GPG Commit Signing and SSH Authentication"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css><link rel=stylesheet href=/css/layouts/single.css><link rel=stylesheet href=/css/navigators/sidebar.css><link rel=stylesheet href=/css/style.css></head><body data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/><img src=/images/site/main-logo_hu9ad2f25a877e6fef77c7a3dbef5094ad_6881_42x0_resize_box_3.png alt=Logo>
Nick's Blog</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><div id=theme-initialization style=display:none default-theme=dark></div><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# onclick=enableLightTheme()><img class=menu-icon-center src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme"></a>
<a class="dropdown-item nav-link" href=# onclick=enableDarkTheme()><img class=menu-icon-center src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a>
<a class="dropdown-item nav-link" href=# onclick=useSystemTheme()><img class=menu-icon-center src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/site/main-logo_hu9ad2f25a877e6fef77c7a3dbef5094ad_6881_42x0_resize_box_3.png class=d-none id=main-logo alt=Logo>
<img src=/images/site/ProtonDark_huf55f086d68c415c8a5704a5012e4d3cc_88195_42x0_resize_box_3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts/ data-filter=all>Posts</a></li><div class=subtree><li><a class=active href=/posts/yubikey/ title="YubiKey 5C Setup">YubiKey 5C Setup</a></li><li><a href=/posts/gitmit/ title="Collaborating with Git Mit">Collaborating with Git Mit</a></li><li><a href=/posts/cluster_upgrade/ title="K8s Cluster Upgrade">K8s Cluster Upgrade</a></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/posts/yubikey/yubikey.jpeg)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/author/nick_hu9e7d2b4d4560f0e9dc945184bd8654c3_2557593_120x120_fit_box_3.png alt="Author Image"><h5 class=author-name>Nick Ruffles</h5><p>Friday, October 7, 2022</p></div><div class=title><h1>YubiKey 5C commit signing and SSH authentication</h1></div><div class=taxonomy-terms><ul style=padding-left:0><li class=rounded><a href=/tags/security/ class="btn, btn-sm">Security</a></li><li class=rounded><a href=/tags/yubikey/ class="btn, btn-sm">YubiKey</a></li><li class=rounded><a href=/tags/ssh/ class="btn, btn-sm">SSH</a></li><li class=rounded><a href=/tags/authentication/ class="btn, btn-sm">Authentication</a></li><li class=rounded><a href=/tags/gpg/ class="btn, btn-sm">GPG</a></li></ul></div><div class=post-content id=post-content><p>While being onboarded to my new job at <a href=https://engineerbetter.com>EngineerBetter</a>, I was handed a YubiKey and asked to
set it up with SSH authentication and commit signing. While I had heard of GPG and used it slightly before, I wasn&rsquo;t aware
that you could also use it in git to sign your commits in order to prove that you were the one to commit code.</p><p>The setup for my YubiKey took me about a day, as there was issue after issue with the YubiKey, so in this guide I hope to
show a relatively painless and secure setup for the YubiKey.</p><p>This blog will walk through how to set up <code>SSH authentication</code> and <code>commit signing</code> with <code>GPG keys</code> on the <code>YubiKey 5C</code> for <code>macOS</code>.
This will be very useful for developers, however if you write any amount of code it can still be cool to set up.
Storing your SSH key on the YubiKey allows you to use the same SSH key on multiple devices by simply plugging in the key
and typing a password (really cool if you have multiple devices)</p><h2 id=useful-commands-and-information>Useful commands and information</h2><pre tabindex=0><code>Default PIN: 123456
Default Admin PIN: 12345678
</code></pre><p>If you have an experience anything similar to me, then you&rsquo;ll likely need to reset the YubiKey keys or GPG values a couple of times. You can reset the YubiKey using the <code>YubiKey Manager</code> by going to <code>Applications -> PIV -> Reset</code> or by entering the following command into the terminal</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ykman openpgp reset <span style=color:#75715e># Reset the GPG keys</span>
</span></span><span style=display:flex><span>$ ykman piv reset     <span style=color:#75715e># Reset the PIN, Admin PIN and Management Key</span>
</span></span></code></pre></div><h2 id=setup-for-macos>Setup for macOS</h2><p>We need to install the <code>openssh</code> version of ssh, as the default Mac one does not have the features we need. The other dependencies are required for YubiKey cli.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ brew install gnupg yubikey-personalization hopenpgp-tools ykman pinentry-mac openssh
</span></span><span style=display:flex><span>$ export PATH<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>brew --prefix openssh<span style=color:#66d9ef>)</span>/bin:$PATH
</span></span></code></pre></div><p>Set up the GPG agent to prompt for a pin using <code>pinentry-mac</code>, this will allow us to enter the YubiKey pin when we first plug the YubiKey into our mac. We&rsquo;ll also tell GPG to support SSH, so that we can use our GPG key as an SSH key - More on this later.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cat <span style=color:#e6db74>&lt;&lt;EOF&gt;&gt; ~/.gnupg/gpg-agent.conf
</span></span></span><span style=display:flex><span><span style=color:#e6db74># if on MacOS, we recommend you use pinentry-mac
</span></span></span><span style=display:flex><span><span style=color:#e6db74># otherwise, look for &#39;pinentry&#39; on your system (e.g. pinentry-gnome3 or pinentry-tty).
</span></span></span><span style=display:flex><span><span style=color:#e6db74># If you don&#39;t set this, the default pinentry will be used
</span></span></span><span style=display:flex><span><span style=color:#e6db74>pinentry-program `which pinentry-mac`
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74># enables SSH support (ssh-agent)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>enable-ssh-support
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span></code></pre></div><p>Run these commands to restart the GPG agent</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ gpg-connect-agent killagent /bye
</span></span><span style=display:flex><span>$ gpg-connect-agent /bye
</span></span></code></pre></div><p>Set the retries attempt for the pin, as 3 retries is the default and this would lock us out of the YubiKey quite quickly if we forget the password or typo on occasion.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ykman piv set-pin-retries <span style=color:#ae81ff>10</span> <span style=color:#ae81ff>10</span>
</span></span></code></pre></div><h2 id=generating-the-gpg-key>Generating the GPG key</h2><p>Create the GPG keys on the YubiKey, this will be stored directly on the YubiKey (not the local file system). The YubiKey will need to be inserted in order to authenticate, sign or encrypt data.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ gpg --edit-card
</span></span><span style=display:flex><span>gpg&gt; admin
</span></span><span style=display:flex><span>gpg&gt; generate
</span></span><span style=display:flex><span><span style=color:#75715e># Follow setup, make sure to set an email that is used in your Github account. </span>
</span></span><span style=display:flex><span><span style=color:#75715e># You can add multiple emails to your Github if </span>
</span></span><span style=display:flex><span><span style=color:#75715e># you decide to use a private Github account with a work email.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Set the expiry date for the key to be in the region of 2 years</span>
</span></span><span style=display:flex><span><span style=color:#75715e># You&#39;ll also be asked if you want to backup your encryption key, if you plan</span>
</span></span><span style=display:flex><span><span style=color:#75715e># on using the YubiKey only for SSH/Commit signing then choose no. </span>
</span></span><span style=display:flex><span>gpg&gt; quit
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># View the key</span>
</span></span><span style=display:flex><span>$ gpg --list-secret --keyid-format SHORT nick.ruffles@engineerbetter.com
</span></span><span style=display:flex><span>sec&gt; rsa2048/FEDECADE 2022-08-10 <span style=color:#f92672>[</span>SC<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>expires: 2024-08-09<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span> FEEDBEEFC0C0A7D867D34ADEADD0D0CAFEDECADE
</span></span><span style=display:flex><span> Card serial no. <span style=color:#f92672>=</span> <span style=color:#ae81ff>0006</span> <span style=color:#ae81ff>19347066</span>
</span></span><span style=display:flex><span>uid  <span style=color:#f92672>[</span>ultimate<span style=color:#f92672>]</span> Nick Ruffles &lt;nick.ruffles@engineerbetter.com&gt;
</span></span><span style=display:flex><span>ssb&gt; rsa2048/F8D33758 2022-08-10 <span style=color:#f92672>[</span>A<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>expires: 2024-08-09<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>ssb&gt; rsa2048/A809A024 2022-08-10 <span style=color:#f92672>[</span>E<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>expires: 2024-08-09<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Make a note of the long value that you are shown, in this case <code>FEEDBEEFC0C0A7D867D34ADEADD0D0CAFEDECADE</code> as well as the short identifier after<code>rsa2048</code> on the line starting with <code>sec></code>, in this case <code>FEDECADE</code>. You&rsquo;ll see these values being used in later commands.</p><p>Retrieve your SSH public key and your GPG public key from your YubiKey and place them <a href=https://github.com/settings/keys>in your GitHub keys section</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Lists the ssh key we just generated</span>
</span></span><span style=display:flex><span>$ ssh-add -L
</span></span><span style=display:flex><span>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC9Tjj2J16yjs+Msb7+G2+HU5LxEjrMVT5zSdj+kOgcOPw6uZhVKasTsWfZDgpXnqebLBCEw5HQtgcKztCmcSO4t3lNHhtXKuy2fKHLfmZOt3R9xISXW0BKNhyC9zVjHXwK1MFLETGaQuUden7jvTRmVSWlp7mqm+CiBdGhKLt04SQzLa/S/UKcNT7Re79C6qfD/+7lvzL20Zo1fpt2aVh8dvWZymZAICtfQ4l/80BKsgZ+J50VXE63suboJcW1nxsRexWSX6lkAdUSPpx3nAhtuev+Qh5fUwDkMMjmwp+UGHr3xcmJn/WJZyuugBrkf0LaOqGh+AEx6ZFYYHRFHLyZ cardno:19 <span style=color:#ae81ff>123</span> <span style=color:#ae81ff>456</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Place this key in the SSH section of Github keys, should be denoted by a `cardno` prefix</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Using the long identifier we got from the above block</span>
</span></span><span style=display:flex><span>$ gpg --armor --export FEEDBEEFC0C0A7D867D34ADEADD0D0CAFEDECADE <span style=color:#75715e># Long identifier </span>
</span></span><span style=display:flex><span>-----BEGIN PGP PUBLIC KEY BLOCK-----
</span></span><span style=display:flex><span>mQENBGLzavsBCADPRKNmZHoID7Cn4DMmKreVFb1RoF4Ghez3EVwZbvQ3KWf56Sh6
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>...snip...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>C/CCi48etdQebwvdv84UdeNoc/yIveis
</span></span><span style=display:flex><span>-----END PGP PUBLIC KEY BLOCK-----
</span></span><span style=display:flex><span><span style=color:#75715e># Place this key in the GPG section of Github keys</span>
</span></span></code></pre></div><p>Test the ssh authentication with GitHub, useful for pushing code to your git repo</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ssh -T git@github.com
</span></span><span style=display:flex><span>Hi TheDarthMole! You<span style=color:#960050;background-color:#1e0010>&#39;</span>ve successfully authenticated, but GitHub does not provide shell access.
</span></span></code></pre></div><h2 id=setting-up-gpg-for-commit-signing>Setting up GPG for commit signing</h2><p>We will also set up signing git commits with the GPG key, as this will allow git users to verify that the code was committed by you.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git config --global commit.gpgsign true
</span></span><span style=display:flex><span>git config --global user.signingkey FEDECADE <span style=color:#75715e># Small identifier from earlier</span>
</span></span><span style=display:flex><span>git config --global user.name <span style=color:#e6db74>&#34;Nick Ruffles&#34;</span>
</span></span><span style=display:flex><span>git config --global user.email <span style=color:#e6db74>&#34;nick.ruffles@engineerbetter.com&#34;</span>
</span></span></code></pre></div><p>Now to test that the GPG key is successfully signing the commits</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ mkdir /tmp/foo
</span></span><span style=display:flex><span>$ git init
</span></span><span style=display:flex><span>$ touch file
</span></span><span style=display:flex><span>$ git add file
</span></span><span style=display:flex><span>$ git commit -m <span style=color:#e6db74>&#34;test&#34;</span>
</span></span><span style=display:flex><span>$ git log --show-signature
</span></span><span style=display:flex><span>commit 50afc824b6470002bf354b129155de291941b9d2 <span style=color:#f92672>(</span>HEAD -&gt; main<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>gpg: Signature made Wed <span style=color:#ae81ff>10</span> Aug 12:06:41 <span style=color:#ae81ff>2022</span> BST
</span></span><span style=display:flex><span>gpg: using RSA key 35AC1AB55DC65EC3E040BAB12F864F12CE8BC0A
</span></span><span style=display:flex><span>gpg: Good signature from <span style=color:#e6db74>&#34;Nick Ruffles &lt;nick.ruffles@engineerbetter.com&gt;&#34;</span> <span style=color:#f92672>[</span>ultimate<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Author: Nick Ruffles &lt;nick.ruffles@engineerbetter.com&gt;
</span></span><span style=display:flex><span>Date: Wed Aug <span style=color:#ae81ff>10</span> 12:06:41 <span style=color:#ae81ff>2022</span> +0100
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>     test
</span></span></code></pre></div><p>If you get a similar output, the signing worked! You can now rest assured that code pushed from your computer is verified that it has come from your computer.</p><img src=/posts/yubikey/commit_verified.png alt="Verified commit using GPG key" class=center><p>You can <em>optionally</em> go to GitHub and toggle <code>Vigilant mode</code> that will flag unsigned commits as unverified.</p><h2 id=making-our-new-gpg-key-public>Making our new GPG key public</h2><p>Now that we have some working keys (Hopefully!!), we can put the public keys in an online repo so that other people can validate our commits</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ gpg --list-secret nick.ruffles@engineerbetter.com <span style=color:#75715e># Enter the email you used for your key</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Copy the key from the output and replace it in the following commands</span>
</span></span><span style=display:flex><span>$ gpg --keyserver keys.openpgp.org     --send-key 35AC1AB55DC65EC3E040BAB12F864F12CE8BC0A
</span></span><span style=display:flex><span>$ gpg --keyserver keys.gnupg.net       --send-key 35AC1AB55DC65EC3E040BAB12F864F12CE8BC0A
</span></span><span style=display:flex><span>$ gpg --keyserver pgp.mit.edu          --send-key 35AC1AB55DC65EC3E040BAB12F864F12CE8BC0A
</span></span><span style=display:flex><span>$ gpg --keyserver keyserver.ubuntu.com --send-key 35AC1AB55DC65EC3E040BAB12F864F12CE8BC0A
</span></span></code></pre></div><p>You can view your keys URL by going to the keyserver website and searching for the id of your key.</p><h2 id=changing-the-default-credentials>Changing the default credentials</h2><p>You <strong>SHOULD ABSOLUTELY</strong> change the pins for your YubiKey. Anyone with the YubiKey and your <code>PIN</code> can mount and use your GPG credentials SO MAKE SURE YOU CHANGE THE DEFAULT VALUES!!!</p><p>You&rsquo;ll be entering the <code>PIN</code> when you use ssh or sign a commit, so make sure it&rsquo;s memorable. To change some identifiers and the pins (passwd) enter the following commands:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gpg --card-edit
</span></span><span style=display:flex><span><span style=color:#75715e># Toggle into admin mode, allowing us to edit name, sex, url and passwords</span>
</span></span><span style=display:flex><span>gpg&gt; admin
</span></span><span style=display:flex><span>gpg&gt; name
</span></span><span style=display:flex><span>gpg&gt; sex
</span></span><span style=display:flex><span><span style=color:#75715e># The url for your public key, set this to use YubiKey with multiple devices</span>
</span></span><span style=display:flex><span><span style=color:#75715e># e.g. keys.openpgp.org/vks/v1/by-fingerprint/35AC1AB55DC65EC3E040BAB12F864F12CE8BC0A</span>
</span></span><span style=display:flex><span>gpg&gt; url
</span></span><span style=display:flex><span>gpg&gt; passwd
</span></span><span style=display:flex><span>gpg&gt; quit
</span></span></code></pre></div><p>Follow the instructions to change the <code>PIN</code> and the <code>Admin PIN</code>.¡</p><h2 id=optional-security-improvements>Optional security improvements</h2><p>Some optional security improvements that require touching the YubiKey for performing different operations</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ykman openpgp keys set-touch aut on <span style=color:#75715e># Require touch for authentication</span>
</span></span><span style=display:flex><span>ykman openpgp keys set-touch enc on <span style=color:#75715e># Require touch for encryption</span>
</span></span><span style=display:flex><span>ykman openpgp keys set-touch sig on <span style=color:#75715e># Require touch for signature signing</span>
</span></span></code></pre></div><h2 id=using-yubikey-with-another-machine>Using YubiKey with another machine</h2><p>If you&rsquo;ve successfully set up the YubiKey following this guide, then you should be able to simply repeat steps in [[00 - YubiKey Setup Guide#Setup for MacOS]] and [[00 - YubiKey Setup Guide#Setting up GPG for commit signing]] along with the following commands to retrieve the public keys from the YubiKey:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gpg --card-edit
</span></span><span style=display:flex><span>&gt; fetch
</span></span><span style=display:flex><span>&gt; quit
</span></span></code></pre></div><p>The <code>fetch</code> will download keys set in the <code>url</code> parameter we set earlier, so make sure you&rsquo;ve set it beforehand!</p><p>The key should be all setup on your new machine! Easy right?</p><h2 id=honorable-mentions>Honorable mentions</h2><p>This guide has been a collection of existing guides, google searches and trial-and-error for setting up the YubiKey, here are some of the resources I used in this guide:</p><ul><li><a href=https://www.engineerbetter.com/blog/yubikey-ssh/>Paddy Steed&rsquo;s SSH Auth guide</a></li><li><a href=https://www.engineerbetter.com/blog/yubikey-signed-commits/>Paddy Steed&rsquo;s Signed Git Commits guide</a></li><li><a href=https://bhavik.io/2019/02/02/yubikey-git-ssh.html>Bhavik Kumar&rsquo;s Yubikey 5 for Git guide</a></li><li><a href=https://github.com/webbmaffian/yubikey-ssh>Webbmaffian&rsquo;s YubiKey on Mac guide</a></li><li>Stack Overflow</li><li>Cups of Tea ☕️</li></ul></div><div class="row pl-3 pr-3"><div class="col-md-6 share-buttons"><strong>Share on:</strong>
<a class="btn btn-sm linkedin-btn" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fruffles.dev%2fposts%2fyubikey%2f&title=YubiKey%205C%20commit%20signing%20and%20SSH%20authentication" target=_blank><i class="fab fa-linkedin"></i></a>
<a class="btn btn-sm whatsapp-btn" href="https://api.whatsapp.com/send?text=YubiKey%205C%20commit%20signing%20and%20SSH%20authentication https%3a%2f%2fruffles.dev%2fposts%2fyubikey%2f" target=_blank><i class="fab fa-whatsapp"></i></a>
<a class="btn btn-sm email-btn" href="mailto:?subject=YubiKey%205C%20commit%20signing%20and%20SSH%20authentication&body=https%3a%2f%2fruffles.dev%2fposts%2fyubikey%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/TheDarthMole/thedarthmole.github.io/edit/main/content/posts/yubikey/index.md title="Improve this page" target=_blank rel=noopener><i class="fas fa-code-branch"></i>
Improve this page</a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-12 next-article"><a href=/posts/gitmit/ title="Collaborative Development with Git MIT" class="btn btn-outline-info"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>Collaborative Development with Git MIT</div></a></div></div><hr></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#useful-commands-and-information>Useful commands and information</a></li><li><a href=#setup-for-macos>Setup for macOS</a></li><li><a href=#generating-the-gpg-key>Generating the GPG key</a></li><li><a href=#setting-up-gpg-for-commit-signing>Setting up GPG for commit signing</a></li><li><a href=#making-our-new-gpg-key-public>Making our new GPG key public</a></li><li><a href=#changing-the-default-credentials>Changing the default credentials</a></li><li><a href=#optional-security-improvements>Optional security improvements</a></li><li><a href=#using-yubikey-with-another-machine>Using YubiKey with another machine</a></li><li><a href=#honorable-mentions>Honorable mentions</a></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=https://ruffles.dev#about>About</a></li><li class=nav-item><a class=smooth-scroll href=https://ruffles.dev#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=https://ruffles.dev#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=https://ruffles.dev#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=https://ruffles.dev#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=https://ruffles.dev#recent-posts>Recent Posts</a></li><li class=nav-item><a class=smooth-scroll href=https://ruffles.dev#accomplishments>Accomplishments</a></li><li class=nav-item><a class=smooth-scroll href=https://ruffles.dev#achievements>Achievements</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto:nick@ruffles.dev target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>nick@ruffles.dev</span></a></li><li><a href=https://github.com/TheDarthMole target=_blank rel=noopener><span><i class="fab fa-github"></i></span> <span>TheDarthMole</span></a></li><li><a href=https://www.linkedin.com/in/NickRuffles target=_blank rel=noopener><span><i class="fab fa-linkedin"></i></span> <span>Nick Ruffles</span></a></li></ul></div></div></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2022 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script type=text/javascript src=/js/jquery-3.4.1.min.js></script>
<script type=text/javascript src=/js/popper.min.js></script>
<script type=text/javascript src=/js/bootstrap.min.js></script>
<script type=text/javascript src=/js/navbar.js></script>
<script type=text/javascript src=/js/plyr.js></script>
<script type=text/javascript src=/js/main.js></script>
<script type=text/javascript src=/js/darkreader.js></script>
<script type=text/javascript src=/js/darkmode-darkreader.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script>
<script src=/js/single.js></script>
<script>hljs.initHighlightingOnLoad()</script></body></html>